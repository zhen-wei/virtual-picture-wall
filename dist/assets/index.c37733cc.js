var B=Object.defineProperty;var Y=(e,t,n)=>t in e?B(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var f=(e,t,n)=>(Y(e,typeof t!="symbol"?t+"":t,n),n);import{m as E}from"./vendor.09eb8132.js";const C=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}};C();(function(){const e=["paint","largest-contentful-paint","layout-shift","first-input","longtask"];new PerformanceObserver(t=>{for(const n of t.getEntries())switch(n.entryType){case"paint":console.log("FP: \u767D\u5C4F\u6642\u9593"),console.log("FP:",n.startTime);break;case"largest-contentful-paint":console.log("LCP: \u986F\u793A\u6700\u5927\u5167\u5BB9\u5143\u7D20\u6240\u9700\u6642\u9593 \u2013 \u8F09\u5165\u901F\u5EA6 ( Good: \u22642500ms Poor: >4000ms )"),console.log("LCP:",n.startTime);break;case"first-input":console.log("FID: \u9996\u6B21\u8F38\u5165 ( Good: \u2264100ms Poor: >300ms )"),console.log("FID:",n.startTime);break;case"layout-shift":console.log("CLS: \u914D\u7F6E\u8F49\u79FB - \u9801\u9762\u7A69\u5B9A\u6027 ( Good: \u22640.1 Poor: >0.25 )"),console.log("CLS:",n.value);break;case"longtask":console.log("\u9577\u4EFB\u52D9"),console.log(n)}}).observe({entryTypes:e})})();const P=function(){let e=0;return function(t,n){clearTimeout(e),e=setTimeout(t,n)}}(),w=document.getElementById("zoomImgBg"),h=document.getElementById("zoomImg"),M=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),m=new Float32Array(M),o={grabbing:!1,grab:{x:0,y:0},touchZoom:!1,level:1,MAX:16,MIN:1};w.addEventListener("click",()=>{w.style.visibility="",h.style.transform="",document.body.style.overflowY="",m.set(M),o.level=1});w.addEventListener("dragstart",e=>e.preventDefault());h.addEventListener("wheel",e=>{const t=e.deltaY<0||e.deltaX>0,{width:n,height:r}=h.getBoundingClientRect(),s=n/2,i=r/2,a=.05,u=t?1+a:1-a;let[l,c]=[0,0];t?(o.level<=o.MAX&&(l=(e.offsetX-s)*(1-u),c=(e.offsetY-i)*(1-u)),o.level++):(o.level>=o.MIN&&(l=-(m[12]/o.level),c=-(m[13]/o.level)),o.level--),o.level<=o.MAX&&o.level>=o.MIN?(E(m,m,[u,0,0,0,0,u,0,0,0,0,1,0,0,0,0,1]),E(m,m,[1,0,0,0,0,1,0,0,0,0,1,0,l,c,0,1]),h.style.transform=`matrix3d(${m})`):o.level>o.MAX?o.level=o.MAX:o.level=o.MIN});h.addEventListener("mousemove",e=>{if(o.grabbing){const t=(e.x-o.grab.x)/m[0],n=(e.y-o.grab.y)/m[5];o.grab.x=e.x,o.grab.y=e.y,E(m,m,[1,0,0,0,0,1,0,0,0,0,1,0,t,n,0,1]),h.style.transform=`matrix3d(${m})`}});h.addEventListener("mousedown",e=>{o.grabbing=!0,o.grab.x=e.x,o.grab.y=e.y});h.addEventListener("click",e=>{e.stopPropagation()});w.addEventListener("mouseup",()=>{o.grabbing=!1,o.touchZoom=!1});function T(e){h.src=e,w.style.visibility="visible",document.body.style.overflowY="hidden"}class k{constructor(t){f(this,"masonryElement");f(this,"columns");f(this,"gap");f(this,"elementList");f(this,"elementListY");f(this,"itemsHeight");this.masonryElement=t.masonryElement,this.columns=t.columns,this.gap=t.gap,this.elementList=[],this.elementListY=new Float64Array(this.columns),this.itemsHeight=new Float64Array(this.columns)}render(t,...n){const{itemsHeight:r,masonryElement:s,elementList:i}=this;if(n.length){const{gap:l,columns:c}=this,g=this.elementList.length-1;if(i.push(...n),this.elementList.length>this.elementListY.length){const d=new Float64Array(this.elementList.length);d.set(this.elementListY),this.elementListY=d}const p=(s.getBoundingClientRect().width-l*(c-1))/c|0;n.forEach((d,x)=>{let b=r.indexOf(Math.min(...r));this.elementListY[g+x]=r[b],d.style.width=`${p}px`,d.style.left=`${(p+l)*b}px`,d.style.top=`${r[b]}px`;const $=d.getBoundingClientRect();r[b]+=$.height*p/$.width+l}),s.style.height=`${Math.max(...r)}px`}const a=this.elementListY.findIndex(l=>l>=t-window.innerHeight),u=i.slice(a,a+25);for(let l=0;l<u.length;l++){const c=s.children[l],g=u[l];c?c!==g&&c.replaceWith(g):s.appendChild(u[l])}}resize(t={}){window.scrollTo(0,0),t.gap&&(this.gap=t.gap),t.columns&&(this.elementListY.fill(0),this.columns===t.columns?this.itemsHeight.fill(0):(this.itemsHeight=new Float64Array(t.columns),this.columns=t.columns));const{itemsHeight:n,masonryElement:r,columns:s,gap:i}=this;this.elementList.length=25,r.replaceChildren(...this.elementList);const a=(r.getBoundingClientRect().width-i*(s-1))/s|0;this.elementList.forEach((u,l)=>{let c=n.indexOf(Math.min(...n));this.elementListY[l]=n[c],u.style.width=`${a}px`,u.style.left=`${(a+i)*c}px`,u.style.top=`${n[c]}px`;const g=u.getBoundingClientRect();n[c]+=g.height*a/g.width+i}),r.style.height=`${Math.max(...n)}px`}}const v=document.querySelector(".masonry-layout"),F=document.createElement("template"),y=new k({masonryElement:v,columns:A(),gap:16});async function z(){const e=await fetch("./data.json");if(e.ok)return await e.json();throw new Error(`code: ${e.status}, ${e.statusText}`)}async function H(e){const t=e[0];if(t.isIntersecting)try{const n=await z();L.unobserve(t.target),F.innerHTML=n.map(i=>{const{titel:a,width:u,height:l,src:c,types:g}=i,p=g.length-1;return`
        <li class="item">
          <div class="content">
              <picture>
                ${g.map((d,x)=>x===p?`<img loading="lazy" width="${u}" height="${l}" src="${c}.${d}" alt="${a}"/>`:`<source srcset="${c}.${d}" type="image/${d}">`).join(`
`)}
              </picture>
              <p>${a}</p>
          </div>
        </li>`}).join("");const r=F.content,s=r.querySelectorAll("li");v.appendChild(r),y.render(window.scrollY,...s),L.observe(s[s.length-1])}catch(n){console.error(n)}}const L=new IntersectionObserver(H);L.observe(v);function A(){console.log(v.clientWidth);const e=[480,800,1024,1200],t=e.findIndex(n=>window.innerWidth<=n);return t===-1?e.length+1:t+1}function I(){y.render(window.scrollY)}function O(){window.removeEventListener("scroll",I),P(()=>{L.disconnect(),y.resize({columns:A()}),L.observe(y.elementList[y.elementList.length-1]),window.addEventListener("scroll",I)},200)}v.addEventListener("click",e=>{e.target instanceof HTMLImageElement&&y.columns>1&&T(e.target.currentSrc)});window.addEventListener("scroll",I);window.addEventListener("resize",O);
